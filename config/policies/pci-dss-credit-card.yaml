policy:
  id: "pol-001-pci-dss"
  name: "PCI-DSS: Block Credit Card Exfiltration"
  description: "Prevent credit card numbers (PAN) from being sent to external destinations"
  version: "1.2.0"
  enabled: true
  priority: 100

  # Compliance tags for reporting
  compliance_tags:
    - "PCI-DSS 3.4"
    - "PCI-DSS 4.1"
    - "GDPR Article 32"

  # Conditions (all must match)
  conditions:
    all:
      - field: "classification.labels"
        operator: "contains"
        value: "PAN"
      - field: "classification.score"
        operator: ">="
        value: 0.85
      - field: "event_type"
        operator: "in"
        value: ["file_transfer", "network_transfer", "email"]
      - field: "destination"
        operator: "not in"
        value: ["internal-network.company.com", "secure-backup.company.com"]

  # Stateful rule: trigger if 3+ violations in 5 minutes
  stateful:
    window: "5m"
    threshold:
      count: 3
      distinct_field: "user_email"

  # Actions to take when policy matches
  actions:
    - type: "block"
      parameters:
        reason: "Credit card data detected in outbound transfer"

    - type: "alert"
      parameters:
        severity: "critical"
        recipients:
          - "security-team@company.com"
          - "compliance@company.com"
        template: "pci_violation"

    - type: "quarantine"
      parameters:
        retention_days: 90
        encrypt: true

    - type: "log"
      parameters:
        siem_forward: true
        audit_trail: true

  # Additional metadata
  created_by: "security-admin@company.com"
  created_at: "2024-01-15T10:00:00Z"
  updated_at: "2024-01-15T10:00:00Z"
